<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no"/>

    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="css/loading.css"/>
    <style type="text/css">

        #container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            opacity: 0;
        }

        .page {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: absolute;
            /*perspective: 1000px;*/
            overflow: hidden;
        }

        .up {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 50px;
            border: 1px solid #000;
        }

        .down {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 50px;
            border: 1px solid #000;
        }

        /*加载的icon的CSS*/
        .page4 > img {
            position: absolute;
            top: 50%;
            left: 50%;
            opacity: 0;
        }


    </style>

    <title></title>
</head>
<body>

<div id='container'>
    <div class='page page1'>
        <!--<img src="img/background/1.png" width="100%" />-->
        <!--<div class='up'>1</div>-->
        <!--<div class='down'>1</div>-->
    </div>
    <div class='page page2'></div>
    <div class='page page3'></div>
    <div class='page page4'></div>
    <div class='page page5'></div>
    <div class='page page6'></div>
</div>
<div id='loading'>
    <img class='loadingLogo' src="img/logo.png"/>
    <img class='loadingDragonfly' src="img/flydragon/1.png"/>
    <div class='loadingCount'></div>
</div>


<script src="http://apps.bdimg.com/libs/jquery/1.8.3/jquery.min.js"></script>
<script src='js/tool/velocity.min.js'></script>
<script src='js/tool/velocity.ui.js'></script>
<script src='js/globalManager/globalManager.js'></script>
<script src='js/controller/controller.js'></script>
<script src='js/resources/resources.js'></script>
<script src='js/tool/fastclick.js'></script>
<script src='js/page/index.js'></script>
<script src='js/page/page1.js'></script>
<script src='js/page/page2.js'></script>
<script src='js/page/page3.js'></script>
<script src='js/page/page4.js'></script>
<script src='js/page/page5.js'></script>
<script src='js/page/page6.js'></script>


<script>
    $(function () {
        //FastClick.....................................................
        FastClick.attach(document.body);


        var $loading = $('#loading');
        $loading.velocity({opacity: 1}, 1500, 'ease', function () {
            afterLoading();
        });


        //loading页淡入后开始增加渐变....................................
        function afterLoading() {
            var $loadingDragonfly = $loading.find('.loadingDragonfly');
            var $loadingCount = $loading.find('.loadingCount');
            var $loadingLogo = $loading.find('.loadingLogo');
            var timer = null;
            var ease = 'easeInOutQuart';


            //蜻蜓飞入.................................................
            $loadingDragonfly
                    .velocity({top: '0%', left: '100%'}, 0)
                    .velocity({top: '20%', left: '70%'}, 750, ease)
                    .velocity({top: '50%', left: '50%'}, 750, ease, function () {
                        //飞入后开始加载................................
                        timer = setInterval(function () {
                            $loadingLogo.velocity({
                                rotateZ: '+=60',
                            }, {duration: 200, easing: 'linear'});
                        }, 400)
                        $loadingDragonfly.velocity({
                            translateX: 1.5,
                        }, {dalay: 200, duration: 200, easing: ease, loop: true});


                        //同时开始加载资源..............................
                        var resource = new Resources('package.json', function (alreayLoadNumber, totalNum, imgsArray) {

                            if (alreayLoadNumber != totalNum) {
                                var num = (alreayLoadNumber / totalNum) > 1 ? 1 : (alreayLoadNumber / totalNum);
                                $loadingCount.html(parseInt(num * 100) + '%');
                            }
                            else if (alreayLoadNumber == totalNum) {

                                $('#container').velocity({opacity: 1}, 1000, ease, function () {
                                    $loadingCount.html('100%');
                                    clearInterval(timer);//logo停
                                    $loadingDragonfly.velocity('stop');

                                    //停止运动 移动到第一页
                                    setTimeout(function () {
                                        $loading.delay(0).velocity({translateY: -$(window).height()}, 1000, ease);
                                        DoPageChange(0);
                                    }, 0)
                                });
                            }
                        })
                    });

        }
    })
</script>
</body>
</html>